// Generated by CoffeeScript 1.7.1
(function() {
  var JL, JS, cfEnv, generateDump, http, pkg;

  http = require("http");

  pkg = require("../package.json");

  cfEnv = require("..");

  exports.main = function() {
    var cfCore, dump, server;
    cfCore = cfEnv.getCore({
      name: "" + pkg.name + "-test"
    });
    dump = generateDump(cfCore);
    console.log("" + dump + "\n");
    server = http.createServer();
    server.on("request", function(request, response) {
      response.writeHead(200, {
        "Content-Type": "text/plain"
      });
      return response.end(dump);
    });
    return server.listen(cfCore.port, cfCore.bind, function() {
      return console.log("server starting on " + cfCore.url);
    });
  };

  generateDump = function(cfCore) {
    var result, serviceURL, services;
    result = [];
    result.push("cfEnv.getCore(): " + (JL(cfCore)));
    services = cfEnv.getServices();
    result.push("cfEnv.getServices(): " + (JL(services)));
    serviceURL = cfEnv.getServiceURL("cf-env-test", {
      pathname: "database",
      auth: ["username", "password"]
    });
    result.push("cfEnv.getServiceURL(): " + serviceURL);
    return result.join("\n\n");
  };

  JS = function(object) {
    return JSON.stringify(object);
  };

  JL = function(object) {
    return JSON.stringify(object, null, 4);
  };

  if (require.main === module) {
    exports.main();
  }

}).call(this);
